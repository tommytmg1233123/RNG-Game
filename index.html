<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Meme RNG</title>

<style>
body{
margin:0;
font-family:Arial;
background:#111;
color:white;
text-align:center;
overflow:hidden;
}

/* SPINNER */
#spinnerWrap{
position:relative;
width:90%;
margin:40px auto;
overflow:hidden;
border:4px solid white;
height:160px;
}

#spinner{
display:flex;
transition: transform linear;
}

.card{
min-width:160px;
height:160px;
background:#222;
margin:0 4px;
display:flex;
align-items:center;
justify-content:center;
flex-direction:column;
border-radius:10px;
}

.card img{
width:120px;
height:120px;
object-fit:cover;
}

/* NEEDLE */
#needle{
position:absolute;
top:-10px;
left:50%;
transform:translateX(-50%);
font-size:40px;
z-index:5;
}

/* BUTTONS */
button{
padding:12px 24px;
margin:10px;
font-size:18px;
cursor:pointer;
}

/* REVEAL EFFECT */
#reveal{
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
display:none;
align-items:center;
justify-content:center;
font-size:50px;
font-weight:bold;
}

/* SHAKE */
.shake{
animation:shake .5s;
}

@keyframes shake{
0%{transform:translateX(0)}
25%{transform:translateX(10px)}
50%{transform:translateX(-10px)}
75%{transform:translateX(10px)}
100%{transform:translateX(0)}
}

/* PARTICLES */
.particle{
position:fixed;
width:8px;
height:8px;
background:white;
border-radius:50%;
pointer-events:none;
animation:fall 1s linear forwards;
}

@keyframes fall{
to{
transform:translateY(400px);
opacity:0;
}
}

</style>
</head>

<body>

<h1>Meme RNG</h1>

<div id="spinnerWrap">
<div id="needle">â–¼</div>
<div id="spinner"></div>
</div>

<button onclick="spin()">SPIN</button>
<button onclick="showInventory()">Inventory</button>

<div id="reveal"></div>

<audio id="tickSound" src="tick.mp3"></audio>

<script>

/* RARITIES */
const rarities=[
{name:"Common",chance:60,color:"#888"},
{name:"Uncommon",chance:25,color:"#4caf50"},
{name:"Rare",chance:10,color:"#2196f3"},
{name:"Ultra",chance:4.9,color:"#9c27b0"},
{name:"Mythic",chance:.1,color:"#ff9800"},
{name:"Divine",chance:.01,color:"#ffd700"}
];

/* MEMES */
const memes=[];
for(let i=0;i<300;i++){
const r=randomRarity();
memes.push({
name:r.name+" Meme "+i,
rarity:r,
img:"https://picsum.photos/seed/"+i+"/200"
});
}

/* INVENTORY SAVE */
let inventory=JSON.parse(localStorage.getItem("inv")||"[]");

function saveInv(){
localStorage.setItem("inv",JSON.stringify(inventory));
}

/* BUILD SPINNER */
const spinner=document.getElementById("spinner");

function buildSpinner(){
spinner.innerHTML="";
memes.forEach(m=>{
const d=document.createElement("div");
d.className="card";
d.style.boxShadow="0 0 20px "+m.rarity.color;
d.innerHTML=`<img src="${m.img}"><div>${m.rarity.name}</div>`;
spinner.appendChild(d);
});
}
buildSpinner();

/* RNG */
function randomRarity(){
let roll=Math.random()*100;
let total=0;
for(let r of rarities){
total+=r.chance;
if(roll<=total)return r;
}
return rarities[0];
}

/* SPIN */
let spinning=false;

function spin(){

if(spinning)return;
spinning=true;

const tick=document.getElementById("tickSound");
tick.currentTime=0;

let meme=randomMeme();

let index=memes.indexOf(meme);
let distance=(index*168)+4000;

spinner.style.transition="transform 5s cubic-bezier(.1,.7,.1,1)";
spinner.style.transform=`translateX(-${distance}px)`;

/* TICK SOUND LOOP */
let tickInterval=setInterval(()=>{
tick.currentTime=0;
tick.play();
},120);

setTimeout(()=>{
clearInterval(tickInterval);
win(meme);
spinning=false;
},5000);

}

/* RANDOM MEME */
function randomMeme(){
const r=randomRarity();
const pool=memes.filter(m=>m.rarity.name===r.name);
return pool[Math.floor(Math.random()*pool.length)];
}

/* WIN */
function win(m){

inventory.push(m);
saveInv();

showReveal(m);
submitScore(m);

}

/* REVEAL FX */
function showReveal(m){

const r=document.getElementById("reveal");
r.style.display="flex";
r.style.background=m.rarity.color;
r.innerHTML=m.rarity.name+"!!!";
r.classList.add("shake");

for(let i=0;i<30;i++){
particle();
}

setTimeout(()=>{
r.style.display="none";
r.classList.remove("shake");
},2000);

}

/* PARTICLES */
function particle(){
const p=document.createElement("div");
p.className="particle";
p.style.left=Math.random()*window.innerWidth+"px";
p.style.top="0px";
document.body.appendChild(p);
setTimeout(()=>p.remove(),1000);
}

/* INVENTORY */
function showInventory(){
alert(inventory.map(m=>m.rarity.name+" "+m.name).join("\n"));
}

/* ONLINE LEADERBOARD (Firebase template) */
function submitScore(m){
/*
Paste Firebase config here if you want real leaderboard

Example:
firebase.database().ref("scores").push({
rarity:m.rarity.name,
time:Date.now()
});
*/
}

</script>

</body>
</html>
