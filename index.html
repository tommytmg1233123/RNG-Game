<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Meme RNG Game</title>

<style>
body{
    background:#0a0a0a;
    color:white;
    font-family:Arial;
    text-align:center;
}

#spinner{
    width:700px;
    height:160px;
    margin:40px auto;
    overflow:hidden;
    border:4px solid white;
    border-radius:18px;
    position:relative;
    background:#111;
}

#needle{
    position:absolute;
    left:50%;
    top:-18px;
    transform:translateX(-50%);
    border-left:18px solid transparent;
    border-right:18px solid transparent;
    border-top:36px solid red;
    z-index:5;
}

#strip{
    display:flex;
    position:absolute;
    left:0;
    top:0;
}

.item{
    width:160px;
    height:160px;
    display:flex;
    align-items:center;
    justify-content:center;
    flex-direction:column;
    font-size:18px;
    transition:0.3s;
}

.item img{
    width:120px;
    height:120px;
    object-fit:cover;
    border-radius:10px;
}

/* RARITY GLOWS */
.common{ box-shadow:0 0 10px #666 inset; }
.rare{ box-shadow:0 0 20px #0099ff inset; }
.epic{ box-shadow:0 0 25px #aa00ff inset; }
.legendary{ box-shadow:0 0 30px gold inset; }
.ultra{ box-shadow:0 0 40px red inset; }

button{
    padding:15px 30px;
    font-size:20px;
    margin:10px;
    border:none;
    border-radius:10px;
    cursor:pointer;
}

#spinBtn{ background:#00ccff; }
#skipBtn{ background:#ff4444; }

#result img{
    width:180px;
    margin-top:10px;
    border-radius:12px;
}

.flash{
    animation:flash 0.2s infinite;
}

@keyframes flash{
    0%{ background:#111; }
    50%{ background:#222; }
    100%{ background:#111; }
}
</style>
</head>

<body>

<h1>Meme RNG Spin</h1>

<div id="spinner">
    <div id="needle"></div>
    <div id="strip"></div>
</div>

<button id="spinBtn">SPIN</button>
<button id="skipBtn">SKIP</button>

<div id="result"></div>

<h3>Best Rolls</h3>
<ul id="historyList"></ul>

<!-- SOUNDS -->
<audio id="spinSound" src="https://assets.mixkit.co/active_storage/sfx/2003/2003-preview.mp3"></audio>
<audio id="winSound" src="https://assets.mixkit.co/active_storage/sfx/2018/2018-preview.mp3"></audio>

<script>
const items = [
{ name:"Common", rarity:0.60, class:"common", img:"https://i.imgflip.com/30b1gx.jpg" },
{ name:"Rare", rarity:0.25, class:"rare", img:"https://i.imgflip.com/1bij.jpg" },
{ name:"Epic", rarity:0.10, class:"epic", img:"https://i.imgflip.com/26am.jpg" },
{ name:"Legendary", rarity:0.039, class:"legendary", img:"https://i.imgflip.com/2fm6x.jpg" },
{ name:"Ultra Rare", rarity:0.009, class:"ultra", img:"https://i.imgflip.com/4/1otk96.jpg" },
{ name:"GOD TIER", rarity:0.001, class:"ultra", img:"https://i.imgflip.com/3vzej.jpg" }
];

let history=[];
let spinning=false;
let stripPos=0;
let animation;

function makeStrip(){
    const strip=document.getElementById("strip");
    strip.innerHTML="";
    for(let i=0;i<120;i++){
        let item=items[Math.floor(Math.random()*items.length)];
        let div=document.createElement("div");
        div.className="item "+item.class;
        div.innerHTML=`<img src="${item.img}"><div>${item.name}</div>`;
        strip.appendChild(div);
    }
}

function roll(){
    let r=Math.random();
    let total=0;
    for(let item of items){
        total+=item.rarity;
        if(r<=total) return item;
    }
    return items[0];
}

/* ROBLOX STYLE FAST â†’ SLOW SPIN */
function spinTo(targetIndex){
    const strip=document.getElementById("strip");
    const width=strip.children[0].offsetWidth;
    const centerOffset=(700/2)-(width/2);
    const end=-(targetIndex*width)+centerOffset;

    const duration=2200;
    const start=performance.now();
    const spinSound=document.getElementById("spinSound");
    spinSound.currentTime=0;
    spinSound.play();

    spinning=true;

    function frame(t){
        let progress=(t-start)/duration;
        if(progress>1) progress=1;

        /* VERY FAST START */
        let ease = 1 - Math.pow(1-progress,5);

        strip.style.left=stripPos+(end-stripPos)*ease+"px";

        if(progress<1 && spinning){
            animation=requestAnimationFrame(frame);
        }else{
            spinning=false;
            stripPos=parseFloat(strip.style.left)||0;
            finishRoll(targetIndex);
        }
    }
    animation=requestAnimationFrame(frame);
}

function finishRoll(index){
    const strip=document.getElementById("strip");
    const itemDiv=strip.children[index];
    const name=itemDiv.innerText;
    const item=items.find(i=>name.includes(i.name));

    document.getElementById("winSound").play();

    document.getElementById("result").innerHTML=
    `<h2>${item.name}</h2><img src="${item.img}">`;

    history.push(item);
    history.sort((a,b)=>a.rarity-b.rarity);

    const list=document.getElementById("historyList");
    list.innerHTML="";
    history.forEach(h=>{
        let li=document.createElement("li");
        li.innerText=h.name;
        list.appendChild(li);
    });

    document.body.classList.add("flash");
    setTimeout(()=>document.body.classList.remove("flash"),400);
}

document.getElementById("spinBtn").onclick=()=>{
    if(spinning) return;

    makeStrip();
    let result=roll();

    const strip=document.getElementById("strip");
    let target=[...strip.children].findIndex(c=>c.innerText.includes(result.name));
    if(target<0) target=0;

    spinTo(target);
};

document.getElementById("skipBtn").onclick=()=>{
    if(!spinning) return;
    spinning=false;
    cancelAnimationFrame(animation);
};
</script>

</body>
</html>
