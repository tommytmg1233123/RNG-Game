<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Meme RNG Game</title>

<style>
body{
    background:#111;
    color:white;
    font-family:Arial;
    text-align:center;
}

h1{
    margin-top:30px;
}

/* BIGGER SPINNER */
#spinner{
    width:600px;
    height:140px;
    margin:40px auto;
    overflow:hidden;
    border:4px solid white;
    border-radius:16px;
    position:relative;
}

/* NEEDLE POINTER */
#needle{
    position:absolute;
    left:50%;
    top:-15px;
    transform:translateX(-50%);
    width:0;
    height:0;
    border-left:15px solid transparent;
    border-right:15px solid transparent;
    border-top:30px solid red;
    z-index:10;
}

#strip{
    display:flex;
    position:absolute;
    left:0;
    top:0;
}

.item{
    width:140px;
    height:140px;
    background:#222;
    border-right:1px solid #444;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:18px;
}

button{
    padding:14px 30px;
    font-size:20px;
    margin:10px;
    cursor:pointer;
    border:none;
    border-radius:10px;
}

#spinBtn{ background:#00ccff; }
#skipBtn{ background:#ff4444; }

#result img{
    width:160px;
    border:2px solid white;
    border-radius:10px;
    margin-top:10px;
}

#history{
    margin-top:40px;
}
</style>
</head>

<body>

<h1>Meme RNG Spin</h1>

<div id="spinner">
    <div id="needle"></div>
    <div id="strip"></div>
</div>

<button id="spinBtn">SPIN</button>
<button id="skipBtn">SKIP</button>

<div id="result"></div>

<div id="history">
<h3>Best Rolls</h3>
<ul id="historyList"></ul>
</div>

<script>
const items = [
{ name:"Common Meme", rarity:0.6, img:"https://via.placeholder.com/200?text=Common" },
{ name:"Rare Meme", rarity:0.25, img:"https://via.placeholder.com/200?text=Rare" },
{ name:"Epic Meme", rarity:0.1, img:"https://via.placeholder.com/200?text=Epic" },
{ name:"Legendary Meme", rarity:0.05, img:"https://via.placeholder.com/200?text=Legendary" }
];

let history=[];
let spinning=false;
let animation;
let stripPos=0;

function makeStrip(){
    const strip=document.getElementById("strip");
    strip.innerHTML="";
    for(let i=0;i<80;i++){
        let item=items[Math.floor(Math.random()*items.length)];
        let div=document.createElement("div");
        div.className="item";
        div.innerText=item.name;
        strip.appendChild(div);
    }
}

function roll(){
    let r=Math.random();
    let total=0;
    for(let item of items){
        total+=item.rarity;
        if(r<=total) return item;
    }
    return items[0];
}

/* FAST 2 SECOND SPIN */
function spinTo(targetIndex,duration=2000){
    const strip=document.getElementById("strip");
    const width=strip.children[0].offsetWidth;

    /* Center on needle */
    const centerOffset = (600/2) - (width/2);

    const end=-(targetIndex*width)+centerOffset;
    const startTime=performance.now();
    spinning=true;

    function frame(time){
        let progress=(time-startTime)/duration;
        if(progress>1) progress=1;

        /* Fast start slow end */
        let ease=1-Math.pow(1-progress,4);

        strip.style.left=stripPos+(end-stripPos)*ease+"px";

        if(progress<1 && spinning){
            animation=requestAnimationFrame(frame);
        }else{
            spinning=false;
            stripPos=parseFloat(strip.style.left)||0;
            showResult(targetIndex);
        }
    }
    animation=requestAnimationFrame(frame);
}

function showResult(index){
    const strip=document.getElementById("strip");
    const name=strip.children[index].innerText;
    const item=items.find(i=>i.name===name);

    document.getElementById("result").innerHTML=
    "<h2>You Got: "+name+"</h2><img src='"+item.img+"'>";

    history.push(item);
    history.sort((a,b)=>a.rarity-b.rarity);

    const list=document.getElementById("historyList");
    list.innerHTML="";
    history.forEach(h=>{
        let li=document.createElement("li");
        li.innerText=h.name;
        list.appendChild(li);
    });
}

document.getElementById("spinBtn").onclick=()=>{
    if(spinning) return;
    makeStrip();
    let result=roll();

    const strip=document.getElementById("strip");
    let target=[...strip.children].findIndex(c=>c.innerText===result.name);
    if(target<0) target=0;

    spinTo(target);
};

document.getElementById("skipBtn").onclick=()=>{
    if(!spinning) return;
    spinning=false;
    cancelAnimationFrame(animation);

    const strip=document.getElementById("strip");
    let result=roll();
    let target=[...strip.children].findIndex(c=>c.innerText===result.name);
    if(target<0) target=0;

    const width=strip.children[0].offsetWidth;
    const centerOffset = (600/2) - (width/2);

    strip.style.left=-(target*width)+centerOffset+"px";
    stripPos=parseFloat(strip.style.left)||0;
    showResult(target);
};
</script>

</body>
</html>
