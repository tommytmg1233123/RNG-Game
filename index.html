<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Meme RNG</title>

<style>
body{
    margin:0;
    font-family:Arial;
    background:#111;
    color:white;
    text-align:center;
    overflow:hidden;
}

/* SPINNER */
#spinnerWrap{
    position:relative;
    width:80%;
    margin:40px auto;
    overflow:hidden;
    border:4px solid white;
    height:160px;
    background:#000;
}

#spinner{
    display:flex;
    transition: transform 0s linear;
}

.card{
    min-width:160px;
    height:160px;
    background:#222;
    margin:0 4px;
    display:flex;
    align-items:center;
    justify-content:center;
    flex-direction:column;
    border-radius:10px;
}

.card img{
    width:120px;
    height:120px;
    object-fit:cover;
}

/* NEEDLE */
#needle{
    position:absolute;
    top:-10px;
    left:50%;
    transform:translateX(-50%);
    font-size:40px;
    z-index:5;
}

/* BUTTONS */
#controls{
    position:fixed;
    bottom:40px;
    width:100%;
    display:flex;
    justify-content:center;
    gap:10px;
}

button{
    padding:12px 24px;
    font-size:18px;
    cursor:pointer;
}

#skipBtn{
    padding:8px 16px;
    font-size:14px;
}

/* RARITY CHANCES */
#chances{
    position:fixed;
    top:10px;
    right:10px;
    text-align:right;
    font-size:14px;
}

/* REVEAL TEXT */
#reveal{
    position:fixed;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    display:none;
    font-size:40px;
    font-weight:bold;
}

/* SHAKE */
.shake{
    animation:shake .5s;
}

@keyframes shake{
    0%{transform:translateX(0)}
    25%{transform:translateX(10px)}
    50%{transform:translateX(-10px)}
    75%{transform:translateX(10px)}
    100%{transform:translateX(0)}
}

/* PARTICLES */
.particle{
    position:fixed;
    width:8px;
    height:8px;
    background:white;
    border-radius:50%;
    pointer-events:none;
    animation:fall 1s linear forwards;
}

@keyframes fall{
    to{
        transform:translateY(400px);
        opacity:0;
    }
}

/* INVENTORY AT BACK */
#inventoryBack{
    position:absolute;
    bottom:0;
    left:0;
    width:100%;
    height:120px;
    overflow-x:auto;
    display:flex;
    align-items:center;
    padding:5px;
    background:#111;
    border-top:2px solid #444;
}

#inventoryBack .invCard{
    width:100px;
    height:100px;
    margin:0 5px;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    border-radius:8px;
    box-shadow:0 0 10px #000;
}

#inventoryBack .invCard img{
    width:80px;
    height:80px;
    object-fit:cover;
}

</style>
</head>

<body>

<h1>Meme RNG</h1>

<div id="chances"></div>

<div id="spinnerWrap">
    <div id="needle">â–¼</div>
    <div id="spinner"></div>
</div>

<div id="controls">
    <button id="spinBtn" onclick="spin()">SPIN</button>
    <button id="skipBtn" onclick="skipSpin()">SKIP</button>
</div>

<div id="reveal"></div>

<div id="inventoryBack"></div>

<audio id="tickSound" src="tick.mp3"></audio>

<script>

/* RARITIES */
const rarities=[
    {name:"Common",chance:40,color:"#888"},
    {name:"Uncommon",chance:30,color:"#4caf50"},
    {name:"Rare",chance:20,color:"#2196f3"},
    {name:"Ultra",chance:9,color:"#9c27b0"},
    {name:"Mythic",chance:0.9,color:"#ff9800"},
    {name:"Divine",chance:0.1,color:"#ffd700"}
];

/* SHOW RARITY CHANCES */
const chanceEl=document.getElementById("chances");
chanceEl.innerHTML=rarities.map(r=>`${r.name}: ${r.chance}%`).join("<br>");

/* MEMES (replace with real meme URLs) */
const memes=[
    {name:"Doge",rarity:rarities[0],img:"https://i.imgflip.com/4t0m5.jpg"},
    {name:"Pepe",rarity:rarities[1],img:"https://i.imgflip.com/30b1gx.jpg"},
    {name:"Distracted Boyfriend",rarity:rarities[2],img:"https://i.imgflip.com/1ur9b0.jpg"},
    {name:"Drake Hotline",rarity:rarities[3],img:"https://i.imgflip.com/30b1gx.jpg"},
    {name:"Success Kid",rarity:rarities[4],img:"https://i.imgflip.com/1bh3.jpg"},
    {name:"Woman Yelling at Cat",rarity:rarities[5],img:"https://i.imgflip.com/345v97.jpg"},
    // duplicate some to fill spinner
    {name:"Doge 2",rarity:rarities[0],img:"https://i.imgflip.com/4t0m5.jpg"},
    {name:"Pepe 2",rarity:rarities[1],img:"https://i.imgflip.com/30b1gx.jpg"},
    {name:"Distracted Boyfriend 2",rarity:rarities[2],img:"https://i.imgflip.com/1ur9b0.jpg"},
];

/* INVENTORY */
let inventory=[];

/* BUILD SPINNER */
const spinner=document.getElementById("spinner");

function buildSpinner(){
    spinner.innerHTML="";
    memes.forEach(m=>{
        const d=document.createElement("div");
        d.className="card";
        d.style.boxShadow=`0 0 20px ${m.rarity.color}`;
        d.innerHTML=`<img src="${m.img}"><div>${m.rarity.name}</div>`;
        spinner.appendChild(d);
    });
}
buildSpinner();

/* LOOP SPINNER FIX */
function getSpinnerWidth(){
    return spinner.scrollWidth;
}

/* RNG */
function randomRarity(){
    let roll=Math.random()*100;
    let total=0;
    for(let r of rarities){
        total+=r.chance;
        if(roll<=total)return r;
    }
    return rarities[0];
}

function randomMeme(){
    const r=randomRarity();
    const pool=memes.filter(m=>m.rarity.name===r.name);
    return pool[Math.floor(Math.random()*pool.length)];
}

/* SPIN */
let spinning=false;

function spin(){
    if(spinning)return;
    spinning=true;

    const tick=document.getElementById("tickSound");
    tick.currentTime=0;

    let meme=randomMeme();
    let index=memes.indexOf(meme);

    // loop distance to prevent going into darkness
    const totalWidth=getSpinnerWidth();
    let distance=(index*168) % totalWidth + 4000;

    spinner.style.transition="transform 5s cubic-bezier(.1,.7,.1,1)";
    spinner.style.transform=`translateX(-${distance}px)`;

    let tickInterval=setInterval(()=>{
        tick.currentTime=0;
        tick.play();
    },120);

    setTimeout(()=>{
        clearInterval(tickInterval);
        win(meme);
        spinning=false;
    },5000);
}

/* SKIP SPIN */
function skipSpin(){
    if(spinning){
        spinner.style.transition="none";
        spinner.style.transform=`translateX(0px)`;
        spinning=false;
    }
}

/* WIN */
function win(m){
    inventory.push(m);
    showInventoryBack();
    showReveal(m);
}

/* REVEAL MINIMAL */
function showReveal(m){
    const r=document.getElementById("reveal");
    r.style.display="block";
    r.innerHTML=m.rarity.name; // just text
    r.classList.add("shake");
    setTimeout(()=>{
        r.style.display="none";
        r.classList.remove("shake");
    },1500);
}

/* INVENTORY AT BACK */
function showInventoryBack(){
    const invEl=document.getElementById("inventoryBack");
    invEl.innerHTML="";
    inventory.forEach(m=>{
        const d=document.createElement("div");
        d.className="invCard";
        d.style.boxShadow=`0 0 10px ${m.rarity.color}`;
        d.innerHTML=`<img src="${m.img}"><div>${m.rarity.name}</div>`;
        invEl.appendChild(d);
    });
}

</script>

</body>
</html>
