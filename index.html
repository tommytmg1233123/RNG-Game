<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>RNG World</title>

<style>
body{
margin:0;
overflow:hidden;
font-family:Arial;
}

/* ===== WORLD ===== */

#world{
position:fixed;
inset:0;
background:#5ecbff;
overflow:hidden;
}

.ground{
position:absolute;
bottom:0;
height:180px;
width:100%;
background:#4caf50;
}

.tree{
position:absolute;
bottom:180px;
width:40px;
height:100px;
background:#6d4c41;
}
.tree::after{
content:"";
position:absolute;
bottom:70px;
left:-40px;
width:120px;
height:100px;
background:#2e7d32;
border-radius:50%;
}

.river{
position:absolute;
bottom:0;
height:120px;
width:200px;
background:#2196f3;
}

/* ===== PLAYER ===== */

#player{
position:absolute;
width:30px;
height:70px;
bottom:200px;
left:200px;
}

.line{
position:absolute;
background:black;
}

.head{
width:20px;
height:20px;
border:3px solid black;
border-radius:50%;
background:white;
left:5px;
}

.body{
width:4px;
height:30px;
left:13px;
top:22px;
}

.arm{
width:4px;
height:20px;
top:25px;
}

.arm.left{ left:0; transform:rotate(30deg); }
.arm.right{ right:0; transform:rotate(-30deg); }

.leg{
width:4px;
height:25px;
top:45px;
}

.leg.left{ left:6px; transform:rotate(10deg); }
.leg.right{ right:6px; transform:rotate(-10deg); }

/* ===== WHEEL TOP ===== */

#wheelWrap{
position:fixed;
top:20px;
left:50%;
transform:translateX(-50%);
width:900px;
height:140px;
overflow:hidden;
background:#111;
border:3px solid white;
border-radius:12px;
}

#wheel{
display:flex;
}

.item{
width:140px;
height:140px;
margin:0 4px;
display:flex;
align-items:center;
justify-content:center;
background:#222;
border-radius:10px;
}

.item img{
width:120px;
height:120px;
border-radius:8px;
}

/* PIN TOP */

#pin{
position:fixed;
top:0px;
left:50%;
transform:translateX(-50%);
font-size:50px;
color:red;
z-index:10;
}

/* ===== BUTTONS BOTTOM ===== */

#ui{
position:fixed;
bottom:30px;
left:50%;
transform:translateX(-50%);
text-align:center;
}

#spinBtn{
padding:16px 70px;
font-size:28px;
border-radius:14px;
border:none;
background:#00e5ff;
color:white;
cursor:pointer;
}

#skipBtn{
margin-top:8px;
padding:6px 25px;
}

/* ===== POPUP ===== */

#popup{
position:fixed;
top:40%;
left:50%;
transform:translateX(-50%);
font-size:60px;
font-weight:bold;
display:none;
}

/* FLASH */

#flash{
position:fixed;
inset:0;
opacity:0;
pointer-events:none;
transition:opacity .2s;
}

</style>
</head>

<body>

<div id="world">
<div class="ground"></div>

<div class="tree" style="left:400px"></div>
<div class="tree" style="left:900px"></div>

<div class="river" style="left:600px"></div>
<div class="river" style="left:1400px"></div>

<div id="player">
<div class="head"></div>
<div class="body line"></div>
<div class="arm left line"></div>
<div class="arm right line"></div>
<div class="leg left line"></div>
<div class="leg right line"></div>
</div>
</div>

<div id="pin">â–¼</div>

<div id="wheelWrap">
<div id="wheel"></div>
</div>

<div id="ui">
<button id="spinBtn">SPIN</button><br>
<button id="skipBtn">Skip</button>
</div>

<div id="popup"></div>
<div id="flash"></div>

<audio id="tick" src="tick.mp3"></audio>

<script>

/* ===== WORLD MOVEMENT ===== */

let player=document.getElementById("player");
let keys={};
let vx=0;
let vy=0;
let grounded=true;
let worldOffset=0;

document.addEventListener("keydown",e=>keys[e.key.toLowerCase()]=true);
document.addEventListener("keyup",e=>keys[e.key.toLowerCase()]=false);

function worldLoop(){

if(keys["a"]) worldOffset+=4;
if(keys["d"]) worldOffset-=4;

if(keys[" "] && grounded){
vy=14;
grounded=false;
}

vy-=0.7;

let bottom=parseFloat(player.style.bottom||200);
bottom+=vy;

if(bottom<=200){
bottom=200;
vy=0;
grounded=true;
}

player.style.bottom=bottom+"px";
document.getElementById("world").style.transform=`translateX(${worldOffset}px)`;

requestAnimationFrame(worldLoop);
}
worldLoop();

/* ===== RNG ===== */

const RARITIES=[
{name:"Common",chance:55,color:"#888"},
{name:"Rare",chance:25,color:"#2196f3"},
{name:"Ultra",chance:15,color:"#9c27b0"},
{name:"Mythic",chance:4,color:"#ff9800"},
{name:"Divine",chance:1,color:"#ffd700"}
];

const MEMES=[
{img:"https://i.imgflip.com/30b1gx.jpg",rarity:"Common"},
{img:"https://i.imgflip.com/1ur9b0.jpg",rarity:"Rare"},
{img:"https://i.imgflip.com/2fm6x.jpg",rarity:"Ultra"}
];

const wheel=document.getElementById("wheel");

function buildWheel(){
wheel.innerHTML="";
for(let i=0;i<400;i++){
let m=MEMES[i%MEMES.length];
let r=RARITIES.find(x=>x.name===m.rarity);

let d=document.createElement("div");
d.className="item";
d.style.boxShadow=`0 0 20px ${r.color}`;
d.innerHTML=`<img src="${m.img}">`;

wheel.appendChild(d);
}
}
buildWheel();

function pick(){
let roll=Math.random()*100;
let sum=0;
for(let r of RARITIES){
sum+=r.chance;
if(roll<=sum){
let pool=MEMES.filter(m=>m.rarity===r.name);
return pool[Math.floor(Math.random()*pool.length)];
}
}
return MEMES[0];
}

/* ===== SOLS STYLE SPIN ===== */

let spinning=false;
let tickInterval;
let spinStart;

document.getElementById("spinBtn").onclick=startSpin;
document.getElementById("skipBtn").onclick=skipSpin;

function startSpin(){

if(spinning) return;
spinning=true;

let tick=document.getElementById("tick");

wheel.style.transition="none";
wheel.style.transform="translateX(0px)";
wheel.offsetHeight;

let duration=6000;
spinStart=performance.now();

startTickSound();

function anim(t){

let p=(t-spinStart)/duration;
if(p>1)p=1;

let ease=1-Math.pow(1-p,3);
let move=ease*9000;

wheel.style.transform=`translateX(-${move}px)`;

updateTickSpeed(p);

if(p<1 && spinning){
requestAnimationFrame(anim);
}else{
finishSpin();
}
}

requestAnimationFrame(anim);
}

function startTickSound(){
let t=document.getElementById("tick");
tickInterval=setInterval(()=>{
t.currentTime=0;
t.play();
},60);
}

function updateTickSpeed(progress){
clearInterval(tickInterval);
let speed=60+(progress*300);
tickInterval=setInterval(()=>{
let t=document.getElementById("tick");
t.currentTime=0;
t.play();
},speed);
}

function skipSpin(){
if(!spinning)return;
spinning=false;
finishSpin();
}

function finishSpin(){

clearInterval(tickInterval);

let meme=pick();
let r=RARITIES.find(x=>x.name===meme.rarity);

showPopup(r);
flash(r.color);

spinning=false;
}

function showPopup(r){
let p=document.getElementById("popup");
p.innerText=r.name;
p.style.color=r.color;
p.style.display="block";
setTimeout(()=>p.style.display="none",1500);
}

function flash(color){
let f=document.getElementById("flash");
f.style.background=color;
f.style.opacity="0.5";
setTimeout(()=>f.style.opacity="0",300);
}

</script>
</body>
</html>
